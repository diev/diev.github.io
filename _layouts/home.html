<!DOCTYPE html>
{% if page.url contains "/en.html" or page.url contains "-en.html" %}
  {% assign en = true %}
  {% assign lang = "en" %}
  {% assign langx = "-en" %}
  {% assign author = "Dmitrii Evdokimov" %}
{% else %}
  {% assign ru = true %}
  {% assign lang = "ru" %}
  {% assign langx = "" %}
  {% assign author = "Дмитрий Евдокимов" %}
{% endif %}
<html lang="{{ lang }}">
  
  {% include head %}
  
  <body>
    <div class="wrapper">
      <section>
        {% if site.github.is_user_page %}

          {{ content }}

        {% elsif site.github.is_project_page %}
          <div id="title">
            <h1>{{ site.title | default: site.github.repository_name }}</h1>
            <p>{{ site.description | default: site.github.project_tagline }}</p>
            <hr>
            <span class="credits left">Project by <a href="/{{ langx }}" title="Home Page">{{ author }}</a></span>
            <span class="credits right">Hosted on <a href="{{ site.github.repository_url }}" title="Project">GitHub</a></span>
          </div>

          {{ content }}

            <h2>Downloads</h2>
            <div><span class="spinning"></span></div>
            <table class="table-downloads">
              <thead>
                {% if en %}
                  <th>Release Notes</th>
                  <th>Download</th>
                  <th>Date</th>
                {% else %}
                  <th>Релизы и инфо</th>
                  <th>Скачать</th>
                  <th>Дата</th>
                {% endif %}
              </thead>
              <tbody>
              </tbody>
            </table>
            <script>
              $.getJSON("http://api.github.com/repos/{{ site.github.owner_name }}/{{ site.github.repository_name }}/releases").done(function(json) {
                for (var i = 0; i < json.length; i++) {
                  var release = json[i];
                  if (release.assets.length === 0) {
                    continue;
                  }
                  for (var j = 0; j < release.assets.length; j++) {
                    var asset = release.assets[j];
                    var fileSize = Math.round(asset.size / 1024);
                    $(".table-downloads tbody")
                      .append($("<tr>")
                        .append($("<td>")
                          .append($("<a>")
                            .attr("href", release.html_url)
                            .text(release.name)
                          )
                          .append(release.prerelease ? " (pre)" : "")
                        )
                        .append($("<td>")
                          .append(asset.name + " ")
                          .append($("<a>")
                            .attr("href", asset.browser_download_url)
                            .text(fileSize.toLocaleString() + "KB")
                          )
                        )
                        .append($("<td>")
                          .text(asset.updated_at.substring(0, 10))
                        )
                      );
                  }
                }
                $(".spinning").hide();
                $(".table.downloads").fadeIn();
              });
            </script>
            <noscript>
              <p><a href="{{ site.github.releases_url }}" title="Releases">Releases on GitHub</a></p>
            </noscript>
        {% endif %}
      </section>
      
      {% include footer %}
      
  </body>
</html>
